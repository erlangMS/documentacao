\documentclass[12pt]{article}

\usepackage{sbc-template}

\usepackage{graphicx,url}

\usepackage[brazil]{babel}   
\usepackage[latin1]{inputenc}  

     
\sloppy

\title{ERLANGMS: Uma Plataforma em Erlang/OTP para 
Modernização de Sistemas Legados através de uma Abordagem Orientada a Serviços na UnB}

\author{
	Everton Agilar\inst{1},
	Alysson Ribeiro\inst{1},
	Renato Ribeiro\inst{1}
}


\address{Universidade de Brasília -- Campus Universitário Darcy Ribeiro\\
   Caixa Postal -- 70910-90  -- Brasília -- DF -- Brasil
  \email{\{evertonagilar,rcarauta,alyssonribeiro\}@unb.br}
}


\begin{document} 

\maketitle

%\begin{abstract}
%  This meta-paper describes the style to be used in articles and short papers
%  for SBC conferences. For papers in English, you should add just an abstract
%  while for the papers in Portuguese, we also ask for an abstract in
%  Portuguese (``resumo''). In both cases, abstracts should not have more than
%  10 lines and must be in the first page of the paper.
%\end{abstract}

     
\begin{resumo} 
Nos últimos anos, a modernização dos sistemas legados da Universidade de Brasília (UnB) tem sido 
prioridade para o CPD/UnB. 
A Arquitetura Orientada a Serviços (SOA) surge como uma maneira de solucionar 
este problema, disponibilizando uma abstração de alto nível entre as aplicações e a camada de negócio ou serviço.
Este artigo aborda este tema e descreve alguns resultados obtidos com o uso 
da plataforma ERLANGMS desenvolvido pelo CPD/UnB sob 
uma abordagem orientada a serviços que compreende um processo 
de moderniza\c c\~{a}o e um barramento aderente ao estilo 
arquitetural \textit{Representational State Transfer} (REST). 
Mais especificamente, são discutidos os principais resultados alcançados, 
as quais destacam-se um barramento de serviços 
orientado a contrato de serviços; 
um kit de desenvolvimento (SDK) para criação de serviços; 
um processo denominado SMSOC para guiar as 
atividades de migração de sistemas legados; 
e alguns serviços de apoio 
como um proxy LDAP para unificar o login de usuários e um serviço de autenticação/autorização OAuth2
para os serviços em REST.
\end{resumo}


\section{Introdução}

Os sistemas legados correspondem às aplicações que sustentam o funcionamento 
negocial de uma Instituição e consolidam a maior parte das informações corporativas~\cite{S4_bennett1995legacy}. 
Na Universidade de Brasília (UnB), há uma gama considerável de sistemas legados desenvolvido 
ao longo dos últimos 30 anos pelo CPD/UnB que consistem em um arcabouço 
de regras de negócios que são de vital importância para o 
pleno funcionamento da Instituição. Entretanto, com as 
sucessivas revisões nas regras de negócios para mantê-los alinhados
com as necessidades e a obsolescência tecnológica desses sistemas, 
tornaram-se rígidos e inflexíveis, a ponto de serem de difícil manutenção e evolução. 

De forma geral, os sistemas da UnB dividem-se em
três áreas de negócio: área acadêmica, administrativa e de pessoal.
A maioria desses sistemas foram construídos em diferentes linguagens de programação,
arquiteturas e plataformas que não conversam entre
si, a não ser, por meio do banco de dados. Durante muitos anos,
a linguagem de programação VB foi a predominante. Os dois sistemas mais
importantes escritos em VB são o \emph{Sistema Acadêmico (SIGRA)} e
o \emph{Sistema de Pessoal (SIPES)}, sendo os demais escritos
em VB.Net, C\#, PHP, ASP e Java (a plataforma atual). 

Neste cenário, as tradicionais práticas de manutenção deixam 
de atender \`{a}s organizações, que buscam formas de reduzir 
os custos com a manutenção, maximizar a integração entre os sistemas,
torná-los mais flexíveis às mudanças de forma para prolongar sua vida útil e facilitar a evolução
desses sistemas~\cite{S3_Bisbal:1999}. 


Este artigo apresenta a plataforma ERLANGMS desenvolvida 
para apoiar a modernização de sistemas legados na UnB. Mais
especificamente, o artigo discute as
experiências obtidas na implantação de um barramento de serviços no CPD/UnB e
a implementação de alguns serviços, as quais,
destacam-se:

\begin{itemize}

\item Desenvolvimento de serviços utilizando o processo SMSOC

\item Autenticação de usuários através um serviço proxy LDAP

\item Autenticação e autorização de serviços REST com um serviço OAuth2

\end{itemize} 


\section{Método}


Para conduzir a modernização dos sistemas legados na UnB,
optou-se por experimentar com a arquitetura orientada a servi\c cos, particularmente 
seguindo o \emph{estilo arquitetural REST}, adotado 
em muitas Instituições por causa
da facilidade para invocar serviços 
web a apartir de qualquer sistema~\cite{fielding2000architectural}. 

Assim, foi criada a \emph{plataforma ERLANGMS}, 
que compreende: (a) um barramento de serviços 
desenvolvido em \emph{Erlang/OTP} para publicar os serviços;
(b) um processo de modernização
denominado \emph{Software Modernization through Service Oriented Computing (SMSOC)} 
para guiar os trabalhos de modernização e disponibilizar uma arquitetura de 
software padronizada para criação dos serviços e;
(c) um kit de desenvolvimento (SDK) para desenvolver os serviços na linguagem Java
\footnote{Está em desenvolvimento o SDK .Net para implementação de serviços nas linguagens C\# eVB.Net.}.

Embora \emph{SOA} seja um tema
de crescente interesse por parte dos pesquisadores e da indústria, identificou-se 
a necessidade prévia de condução de um mapeamento sistemático para 
caracterizar a modernização de sistemas legados no 
contexto da manutenção de software~\cite{desystematic2016}. 
Desse modo, muitas decisões de design da plataforma
foram definidas a partir deste estudo prévio onde verificou-se
que a maior parte das contribuições na literatura
estão relacionados aos aspectos gerenciais da modernização de software (55,88\% das
publicações) e há poucos relatos de contribuições que descrevem (ou validem)
técnicas ou ferramentas de modernização de software, como ERLANGMS.


\section{Resultados}

Nesta seção são descritos os resultados deste trabalho, A Subseção~\ref{plataforma}
apresenta uma visão geral da plataforma ERLANGMS, a Subseção~\ref{smsoc}
discute as experiências como o uso do processo SMSOC. A Subseção~\ref{ldap}
descreve a solução encontrada pelo CPD/UnB para unificar
o login de usuários com o uso de um proxy LDAP e por fim, 
a Subseção~\ref{oauth2}
descreve o esquema de autenticação e autorização proposto 
para os serviços REST.


\subsection{Plataforma ERLANGMS}\label{plataforma}

A plataforma ERLANGMS é constituído 
por um barramento de serviços (\textit{Enterprise Service Bus}-- ESB) 
multiplataforma orientado a contratos de serviços
idealizado para servir de elo entre os 
sistemas da Universidade e a camada de serviço (tipicamente 
implementada usando a linguagem Java). 
De acordo com \cite{ModelDriApproRest:2014}, 
um barramento permite unificar o acesso aos serviços 
através de uma camada intermediadora entre componentes de software (denominados serviços) e 
as aplicações que consomem estes serviços. 
A implementa\c c\~{a}o 
de um novo barramento (em vez da ado\c c\~{a}o de um barramento existente), 
possibilitou uma melhor compreens\~{a}o do estilo arquitetural REST e o dom\'{i}nio de alguns 
elementos chave propostos no ERLANGMS, como a estrutura de eventos e os recursos de toler\^{a}ncia 
a falha. 

A arquitetura segue o conceito de \textit{Service Oriented Computing} (SOC), 
um paradigma que promove a composição de serviços \emph{em uma rede de serviços} 
fracamente acoplados, com o objetivo de criar processos de negócio dinâmicos 
e flexíveis através da interconexão de sistemas computacionais~\cite{ModelDriApproRest:2014}. 
Dessa forma, o barramento suporta a mediação, roteamento, 
transformação de dados e a orquestração dos serviços. Para isso, adotou-se o 
estilo arquitetural REST e o formato JSON para o envio e 
recebimento das mensagens do cliente. Essa restrição de design teve o 
objetivo de facilitar a implementação do barramento e mantê-lo simples. 

O esquema de comunicação da arquitetura ocorre por meio de 
duas vias distintas, como ilustra a Figura~\ref{fig:roteamento_mensagens}: Na primeira via, 
existe a comunicação do cliente para 
consumir algum serviço no barramento. Essa comunicação é via uma 
interface REST, razão pela qual o cliente (que pode ser qualquer sistema, 
independente da sua linguagem de programação ou plataforma) 
precisa suportar chamadas de serviços em REST. Na segunda via, tem a comunicação 
do barramento com o serviço, que está implementado em 
alguma linguagem de programação (Erlang, Java, etc.). Essa comunicação dá-se via
sistema de mensageria disponível em Erlang que possibilita uma comunicação assíncrona 
com várias linguagens de programação de forma muito rápida por trafegar os dados 
no formato binário e com baixa latência na rede\cite{Armstrong:2013:PES:2566708}.

\begin{figure}[htb]
\centering
\includegraphics[scale=0.8]{img/arquitetura/roteamento_mensagens.pdf}
\caption{Roteamento das mensagens na plataforma ERLANGMS.}
\label{fig:roteamento_mensagens}
\end{figure}






\subsection{Desenvolvimento de serviços utilizando o processo SMSOC}\label{smsoc}

A introdução de um processo surgiu devido a necessidade
de documentar um processo de modernização 
para auxiliar os trabalhos de modernização.
O processo SMSOC é 
aderente à arquitetura SOA 
e foi validado como  
resultado de um estudo de caso
conduzido em uma disciplina de Pós-Graduação
do Mestrado Acadêmico em Informática da UnB,
através do qual foi modernizado 
o Sistema de Estudo SocioEconômico (SAE)
que faz a gestão do processo de 
avaliação socioeconômica dos estudantes da UnB.

Para guiar as atividades de modernização, o processo 
divide-se em 4 fluxos de trabalho com atividades gerenciais e técnicas. Cada
atividade apresenta um conjunto de diretrizes para
a migração dos sistemas legados para um ambiente distribuído. 
O SMSOC documenta também a arquitetura e o design
para implementação dos serviços e adota uma 
abordagem de desenvolvimento Domain-Driven
Design (DDD), introduzido no livro \textit{Domain-Driven Design: Tackling Complexity in the
Heart of Software}, para o desenvolvimento de sistemas complexos centrado no domínio
do negócio e no trabalho cooperativo entre especialistas do negócio e desenvolvedores~\cite{evans2004domain}.

Há vários benefícios observados com o SMSOC,
por exemplo, por ser um processo enxuto para as 
necessidades da UnB, possibilita
a sua execução até mesmo em projetos ou equipes muito pequenas. Além disso
o processo apresenta diretrizes e boas práticas recomendadas além de conter
um design padronizado 
da arquitetura dos serviços, o que facilita o aprendizado por novos membros na equipe
de desenvolvimento e serve como 
uma excelente documentação. Em Dezembro de 2016, após três semanas de 
treinamento, a equipe de desenvolvedores da área de sistemas administrativos 
iniciou o desenvolvimento de vários serviços solicitados pela UnB. 
Em contraposição aos benefícios,
identificou-se certa resistência por desenvolvedores com 
mais experiência na arquitetura antiga, em virtude dos sistemas
legados trabalharem com a abordagem \textit{TransactionScript} enquanto que 
ERLANGMS adota a abordagem DDD. Uma comparação
destas duas abordagens pode ser encontrada em~\cite{agilar2016}.




\subsection{Autenticação de usuários através um serviço proxy LDAP}\label{ldap}

A UnB tem buscado desde 2013 uma forma de unificar o acesso dos usuários aos
sistemas de informação e a rede corporativa, uma vez que existem muitos
silos de dados de usuários que dificultam a centralização dessas informações. 

De modo a suprir esta demanda e subsidiar a concretização do acesso 
unificado bem como o compartilhamento de informações de usuários
com as aplicações (até mesmo com sistemas não desenvolvidos pelo CPD/UnB), 
foi implementado um serviço proxy LDAP no barramento de serviços.
O LDAP ou Lightweight Directory Access Protocol é um 
protocolo padrão comumente utilizado pelas aplicações para autenticar os usuários,
sendo um dos protocolos de autenticação mais utilizados no ambiente da UnB.

Desde que este serviço foi colocado em produção para 
autenticar alguns sistemas na UnB (como é o caso do Redmine e muito em breve o SEI 3.0),
o proxy LDAP tem sido visto pela Direção do CPD/UnB como uma ferramenta
com alto potencial para integrar não somente os sistemas da Universidade
mas também a rede corporativa (Webmail e UnB Wireless).

Note que a maior vantagem de se utilizar um serviço que entende LDAP
em vez de uma instância OpenLDAP convencional por exemplo, 
é permitir que base de usuários possa
estar em um banco de dados relacional onde tipicamente os sistemas da própria Instituição
já tem acesso direto. Os demais sistemas (internos ou não), sites institucionais 
e gerenciadores de conteúdo (Joomla, Wordpress, etc.)
poderiam consultar e autenticar os usuários através do serviço proxy LDAP 
exatamente da mesma forma que faria se fosse um servidor OpenLDAP.



\subsection{Autenticação e autorização de serviços REST com um serviço OAuth2}\label{oauth2}

Com o desenvolvimento de sistemas com uma abordagem SOA, torna-se
importante controlar o acesso e a autorização das chamadas de serviços REST.
Nesse sentido, foi desenvolvimento suporte nativo para autenticação OAuth2
no barramento de serviços. 


O OAuth (\textit{Open Authorization Protocol}) é um protocolo de autorização 
que permite as aplicações possam obter 
acesso limitado a um serviço através de trocas de 
mensagens e \textit{tokens} de acesso. 
Este protocolo ainda está em desenvolvimento sendo que 
um estudo prévio foi conduzido para escolher o protocolo a ser adotado
na solução ERLANGMS~\cite{7521451}.


Resumidamente, o suporte da autenticação OAuth2 foi dividido em duas partes no barramento de serviços.
Na primeira parte realizou-se a implementação
da geração do token que não é uma operação trivial.
A segunda parte, que representa 
o desafio atual, é fazer a integração com o Sistema de Controle de Acesso (SCA)
de maneira agnóstica, uma vez que o barramento pode ser utilizado 
por qualquer organização, sendo portanto, preferível não acoplar com 
os sistemas internos da UnB.


\end{description}

\section{Conclusões}

Uma das vantagens que se observou na abordagem proposta foi permitir que tanto 
os sistemas novos quanto os sistemas legados possam coexistir, invocando os mesmos serviços e
maximizando o compartilhamento das regras de negócio.


\bibliographystyle{sbc}
\bibliography{bibliografia}

\end{document}
